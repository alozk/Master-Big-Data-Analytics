# Docker Compose
Docker Compose es una herramienta para definir y ejecutar aplicaciones de Docker de varios contenedores. En Compose, se usa un archivo YAML para configurar los servicios de la aplicación. Después, con un solo comando, se crean y se inician todos los servicios de la configuración.

Es decir, funciona como aplicaciones multicontenedor en el que se pueden configurar desde un único archivo de texto YAML lo siguientes:
- Contenedores
- Imágenes
- Volúmenes
- Redes

Antes de ver los comandos, vayamos a la página oficial de Docker para ver la documentación acerca de la instalación del compose.
https://docs.docker.com/compose/install/compose-plugin/

1. Instala Docker compose (con sudo mejor)
2. Darle permisos de ejecución
3. Comprueba con:
docker-compose

## Primeros pasos en Compose
Crea una carpeta llamada docker-compose
<pre><code>mkdir docker-compose</pre></code>
Busca la carpeta y situate en ella
<pre><code>ls</pre></code>
<pre><code>cd docker-compose/</pre></code>

ahora debemos en la propia carpeta crear el archivo yaml, con el nombre docker-compose:
subl docker-compose.yml

Si el comando subl no funciona, crea el archivo txt, escribes dentro el docker-compose que vamos a escribir más adelante y le cambias la terminación txt por yml una vez hayas guardado el archivo (recuerda, en la carpeta docker-compose que hemos creado anteriormente).

Ahora nos disponemos a construir nuestro nuevo archivo yml.
Buscamos docker compose version en internet
Vamos a usar un ngnix pero puedes buscar y usar el que quieras
Buscamos docker docs compose en internet para más información

Con lo comentado, construimos nuestro archivo y quedaría así:
 ````
version: '3'
services:
 web:
  image: nginx
  container_name: nginx1
  ports:
  - "8080:80"
````
Advertencias:
los espacios en el archivo yml tienen que ser así, nada de tabulaciones. Fíjense que: entre version y '3', tiene que haber un espacio; que web tiene un espacio; lo que está abajo de web contiene dos espacios, etc.

Para hacerlo correr, ejecutamos el siguiente comando:
<pre><code>docker-compose up</pre></code>

## Variables de entorno en compose
Podemos acceder a la información oficial y buscar acerca del environment aquí: https://docs.docker.com/compose/compose-file/
Construyamos un ejemplo:

<pre><code>
version: '3'
services:
 db:
  image: mysql:5.7
  container_name: mysql
  ports:
   - "3306:3306"
  environment:
   - "MYSQL_ROOT_PASSWORD=1234"
</pre></code>

Para comprobar que tenemos la variable de entorno lista para funcionar:
<pre><code>docker exec -ti mysql bash</pre></code>
Una vez dentro del contenedor ejecutamos:
<pre><code>env</pre></code>
Y podremos observar que tenemos nuestra variable de entorno lista para funcionar.
Y ejecutamos el siguiente comando (tras el -p hay que poner la contraseña que nosotros pusimos):
<pre><code>mysql -u root -p1234</pre></code>

## Volúmenes en compose

Existen 3 tipos de volúmenes:
 - Anonymous
 - Named
 - Host

Veamos el named o nombrado. ¿Cómo lo hacemos?
<pre><code>docker volume create name</pre></code>

¿Y en el docker compose como lo haríamos?
En la documentación también podemos ver como se harían: https://docs.docker.com/compose/compose-file/
 ````
version: '3'
services:
 web:
  image: nginx
  container_name: nginx1
  ports:
   - "8080:80"
  volumes:
   - "vol2:/usr/share/nginx/html" 
volumes:
 vol2:
````
La ruta 'usr/share/nginx/html' es la que utiliza nginx para los archivos html.